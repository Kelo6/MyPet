<!--pages/knowledge-detail/knowledge-detail.wxml-->
<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner">
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
  </view>

  <!-- æ–‡ç« å†…å®¹ -->
  <view wx:else class="article-container">
    <!-- æ–‡ç« å¤´éƒ¨ -->
    <view class="article-header">
      <view class="article-meta">
        <view class="category-badge">
          <text class="category-icon">{{getCategoryIcon(article.category)}}</text>
          <text class="category-text">{{getCategoryLabel(article.category)}}</text>
        </view>
        <text class="article-date">{{formatDate(article.updatedAt)}}</text>
      </view>
      
      <text class="article-title">{{article.title}}</text>
      
      <view class="article-info">
        <text class="reading-time">ğŸ“– {{getReadingTime(article.contentMD)}}åˆ†é’Ÿé˜…è¯»</text>
        <text class="word-count">{{getWordCount(article.contentMD)}}å­—</text>
      </view>
    </view>

    <!-- æ–‡ç« æ­£æ–‡ -->
    <view class="article-content">
      <rich-text nodes="{{renderedContent}}" />
    </view>

    <!-- æ–‡ç« åº•éƒ¨ -->
    <view class="article-footer">
      <view class="footer-actions">
        <button class="action-btn secondary" bindtap="onShare">
          <text class="btn-icon">ğŸ“¤</text>
          <text class="btn-text">åˆ†äº«</text>
        </button>
        <button class="action-btn secondary" bindtap="onCollect">
          <text class="btn-icon">{{isCollected ? 'â¤ï¸' : 'ğŸ¤'}}</text>
          <text class="btn-text">{{isCollected ? 'å·²æ”¶è—' : 'æ”¶è—'}}</text>
        </button>
        <button class="action-btn primary" bindtap="onFeedback">
          <text class="btn-icon">ğŸ’¬</text>
          <text class="btn-text">åé¦ˆ</text>
        </button>
      </view>
      
      <view class="copyright">
        <text class="copyright-text">æœ¬å†…å®¹ä»…ä¾›å‚è€ƒï¼Œå…·ä½“æƒ…å†µè¯·å’¨è¯¢ä¸“ä¸šå…½åŒ»</text>
      </view>
    </view>

    <!-- ç›¸å…³æ¨è -->
    <view wx:if="{{relatedArticles.length > 0}}" class="related-section">
      <view class="section-header">
        <text class="section-title">ç›¸å…³æ¨è</text>
      </view>
      
      <view class="related-list">
        <view 
          wx:for="{{relatedArticles}}" 
          wx:key="_id"
          class="related-item"
          bindtap="onRelatedArticle"
          data-article="{{item}}"
        >
          <view class="related-icon">
            <text class="icon-emoji">{{getCategoryIcon(item.category)}}</text>
          </view>
          <view class="related-content">
            <text class="related-title">{{item.title}}</text>
            <text class="related-summary">{{getArticleSummary(item.contentMD)}}</text>
          </view>
          <view class="related-arrow">></view>
        </view>
      </view>
    </view>
  </view>

  <!-- æµ®åŠ¨æ“ä½œæŒ‰é’® -->
  <view class="floating-actions">
    <view class="floating-btn" bindtap="onScrollToTop">
      <text class="floating-icon">â¬†ï¸</text>
    </view>
  </view>
</view>




